ft_1 <- flextable( head( iris ))
packages <- c("tidyverse","flextable")
lapply(packages, require, character.only = TRUE)
ft_1 <- flextable( head( iris ))
View(ft_1)
ft_1
typology <- data.frame(
col_keys = c( "Sepal.Length", "Sepal.Width", "Petal.Length",
"Petal.Width", "Species" ),
unit = c("(cm)", "(cm)", "(cm)", "(cm)", ""),
stringsAsFactors = FALSE )
typology
ft_2 <- set_footer_df(ft_1, mapping = typology, key = "col_keys" )
ft_2 <- italic(ft_2, italic = TRUE, part = "footer" )
typology <- data.frame(
col_keys = c( " ", "全体 (n=890)", "検査陽性 (n=290)","検査陰性 (n=600)"),
unit = c("*接種歴のある267名のみ", " ", " ", " "),
stringsAsFactors = FALSE )
df_2 <- readxl::read_excel("./data/ve_nagasaki_table.xlsx",sheet = 2,skip = 2) %>%
slice(-10) %>%
rename(" "=1)
typology <- data.frame(
col_keys = c( " ", "全体 (n=890)", "検査陽性 (n=290)","検査陰性 (n=600)"),
unit = c("*接種歴のある267名のみ", " ", " ", " "),
stringsAsFactors = FALSE )
df_2 <- readxl::read_excel("./data/ve_nagasaki_table.xlsx",sheet = 2,skip = 2) %>%
slice(-10) %>%
rename(" "=1)
typology <- data.frame(
col_keys = c( " ", "全体 (n=890)", "検査陽性 (n=290)","検査陰性 (n=600)"),
unit = c("*接種歴のある267名のみ", " ", " ", " "),
stringsAsFactors = FALSE )
ft_2 <- regulartable(data = df_2, col_keys = names(df_2),
cwidth = 1.8, cheight = 0.20)
ft_2 <- set_footer_df(ft_2, mapping = typology, key = "col_keys" )
ft_2 <- align(ft_2,j = c("全体 (n=890)","検査陽性 (n=290)","検査陰性 (n=600)"), align = "right", part = "body")
ft_2
